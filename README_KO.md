# Hon (í˜¼)

[ğŸ‡°ğŸ‡· í•œêµ­ì–´ (Korean)](README_KO.md) | [ğŸ‡ºğŸ‡¸ English](README.md)

**Hon**ì€ [CloudWeGo Netpoll](https://github.com/cloudwego/netpoll) ê¸°ë°˜ì˜ ê³ ì„±ëŠ¥ HTTP ì—”ì§„ ì–´ëŒ‘í„°ì…ë‹ˆë‹¤. í‘œì¤€ `net/http` ì¸í„°í˜ì´ìŠ¤ë¥¼ ìœ ì§€í•˜ë©´ì„œ **Reactor íŒ¨í„´**ì„ í†µí•´ ì••ë„ì ì¸ ë™ì‹œì„± ì²˜ë¦¬ ëŠ¥ë ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ğŸš€ ì£¼ìš” íŠ¹ì§•

- **ì••ë„ì ì¸ ë™ì‹œì„±**: **25,000ê°œ ì ‘ì†**ì„ ë‹¨ **6ê°œì˜ ê³ ë£¨í‹´**ìœ¼ë¡œ ì²˜ë¦¬ (99.9% ì ˆê°).
- **ì§„ì •í•œ Reactor í´ë¼ì´ì–¸íŠ¸**: ì„œë²„ì™€ ë™ì¼í•œ ì•„í‚¤í…ì²˜ë¥¼ ê³µìœ í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ë¥¼ ì œê³µí•˜ì—¬, **ì—°ê²°ë‹¹ 0ê°œì˜ ê³ ë£¨í‹´**ìœ¼ë¡œ ëŒ€ê·œëª¨ ë¶€í•˜ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ë¦¬ì†ŒìŠ¤ íš¨ìœ¨ì„±**: Thread-per-Connection ë°©ì‹ì˜ ì˜¤ë²„í—¤ë“œë¥¼ ì œê±°í•˜ì—¬ CPU ì‚¬ìš© íš¨ìœ¨ì„ ê·¹ëŒ€í™”í–ˆìŠµë‹ˆë‹¤.
- **í‘œì¤€ í˜¸í™˜ì„±**: `http.Handler` ì¸í„°í˜ì´ìŠ¤ë¥¼ ì™„ë²½í•˜ê²Œ ì§€ì›í•˜ì—¬ `chi`, `gin`, `echo`, `mux` ë“± ê¸°ì¡´ ë¼ìš°í„°ë¥¼ ì½”ë“œ ë³€ê²½ ì—†ì´ ê·¸ëŒ€ë¡œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
- **ë©”ëª¨ë¦¬ ê´€ë¦¬**: Netpollì˜ ê³ ì„±ëŠ¥ ë©”ëª¨ë¦¬ ìºì‹œ(`mcache`)ë¥¼ í™œìš©í•˜ì—¬ ëŒ€ê·œëª¨ íŠ¸ë˜í”½ ìƒí™©ì—ì„œë„ ë©”ëª¨ë¦¬ í• ë‹¹/í•´ì œ ë¹„ìš©ì„ ìµœì†Œí™”í•˜ê³  ì•ˆì •ì ì¸ ì„±ëŠ¥ì„ ìœ ì§€í•©ë‹ˆë‹¤.
- **Zero-Allocation**: ìì²´ WebSocket íŒŒì„œë¡œ í—¤ë” íŒŒì‹± ì‹œ **0 allocs/op** ë‹¬ì„±.

## ğŸ“Š ì„±ëŠ¥ ë¹„êµ (Hon vs í‘œì¤€ ì„œë²„)

macOS M4 ë¡œì»¬ í™˜ê²½ í…ŒìŠ¤íŠ¸ ê²°ê³¼ì…ë‹ˆë‹¤.

### 1. HTTP ì²˜ë¦¬ëŸ‰ (RPS)
| ëª¨ë“œ | ì´ˆë‹¹ ìš”ì²­ ìˆ˜ (RPS) | ì„±ëŠ¥ í–¥ìƒ |
| :--- | :--- | :--- |
| í‘œì¤€ (`net/http`) | 129,616 | - |
| **Hon** | **233,404** | **+80%** |

> **ë¶„ì„ ê²°ê³¼**: 
> - **Hon**: **Reactor íŒ¨í„´** (Netpoll)ê³¼ íš¨ìœ¨ì ì¸ ë©”ëª¨ë¦¬ í’€ë§ì„ í†µí•´ í‘œì¤€ ëŒ€ë¹„ **+80%** ë” ë†’ì€ ì„±ëŠ¥ì„ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤.

### 2. WebSocket íš¨ìœ¨ì„± (15,000ê°œ ì—°ê²°)
| ëª¨ë“œ | ì‚¬ìš© ì¤‘ì¸ ê³ ë£¨í‹´ ìˆ˜ | ë¦¬ì†ŒìŠ¤ ì ˆê° |
| :--- | :--- | :--- |
| í‘œì¤€ (`gorilla`) | 15,005 ê°œ | - |
| **Hon ì„œë²„** | **6 ê°œ** | **99.96% ì ˆê°** |

### 3. í´ë¼ì´ì–¸íŠ¸ í™•ì¥ì„± (10,000ê°œ ì—°ê²°)
| ì§€í‘œ | Hon í´ë¼ì´ì–¸íŠ¸ | í‘œì¤€ í´ë¼ì´ì–¸íŠ¸ |
| :--- | :--- | :--- |
| **ê³ ë£¨í‹´ ìˆ˜** | **~4 ê°œ (ì „ì²´)** | 20,000ê°œ ì´ìƒ |
| **ì—°ê²° ì†ë„** | **0.48ì´ˆ** | 5.0ì´ˆ ì´ìƒ |
| **ë©”ëª¨ë¦¬ í• ë‹¹** | **0 allocs/op** | ë†’ìŒ |

> **í•µì‹¬ ìš”ì•½**: 
> - **Hon í´ë¼ì´ì–¸íŠ¸**: Netpollì˜ ê¸€ë¡œë²Œ í´ëŸ¬ë¥¼ í™œìš©í•˜ì—¬ ìˆ˜ë§Œ ê°œì˜ ì—°ê²°ì„ ë‹¨ì¼ ìŠ¤ë ˆë“œì²˜ëŸ¼ ê´€ë¦¬í•©ë‹ˆë‹¤. ëŒ€ê·œëª¨ ë¶€í•˜ í…ŒìŠ¤íŠ¸ë‚˜ ê²Œì´íŠ¸ì›¨ì´ ì„œë¹„ìŠ¤ì— ì´ìƒì ì…ë‹ˆë‹¤.

## ğŸ“¦ ì‹œì‘í•˜ê¸°

```bash
# 1. ì„¤ì¹˜
go get github.com/DevNewbie1826/hon

# 2. ì˜ˆì œ ì‹¤í–‰
go run cmd/example/main.go -type hon
```

## ğŸ’¡ ì‚¬ìš©ë²• ì˜ˆì‹œ

### ì„œë²„ (Server)
```go
func main() {
    mux := http.NewServeMux()
    
    // 1. í‘œì¤€ HTTP í•¸ë“¤ëŸ¬ (Gin, Chi, Echo ë“± í˜¸í™˜)
    mux.HandleFunc("/", func(w http.ResponseWriter, r *http.Request) {
        w.Write([]byte("Hello, Hon!"))
    })

    // 2. Hon ìµœì í™” WebSocket
    mux.HandleFunc("/ws", func(w http.ResponseWriter, r *http.Request) {
        adaptor.Upgrade(w, r, &MyWSHandler{})
    })

    eng := engine.NewEngine(mux)
    server.NewServer(eng).Serve(":1826")
}

type MyWSHandler struct { websocket.DefaultHandler }
func (h *MyWSHandler) OnMessage(c net.Conn, op ws.OpCode, payload []byte, fin bool) {
    // ê³ ë£¨í‹´ ìƒì„± ì—†ì´ ì´ë²¤íŠ¸ ë£¨í”„ì—ì„œ ì¦‰ì‹œ ì‹¤í–‰ë©ë‹ˆë‹¤.
    wsutil.WriteServerMessage(c, op, payload)
}
```

### í´ë¼ì´ì–¸íŠ¸ (Client)
```go
// WebSocket ì„œë²„ì— ì—°ê²°
// ì´ ì—°ê²°ì„ ìœ„í•œ ë³„ë„ì˜ ê³ ë£¨í‹´ì´ ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤!
err := websocket.Dial("ws://localhost:1826/ws", &MyClientHandler{})

type MyClientHandler struct { websocket.DefaultHandler }
func (h *MyClientHandler) OnMessage(c net.Conn, op ws.OpCode, p []byte, fin bool) {
    fmt.Printf("Received: %s\n", string(p))
}
```

## ğŸ“„ ë¼ì´ì„ ìŠ¤
MIT License
